"0","check_for_data <- function(metadata) {"
"0","  have_data <- metadata %>%"
"0","    group_by(line, treatment, treatment_days) %>%"
"0","    summarize(have_data = T) "
"0","  have_data$line <- factor(have_data$line, levels = unique(metadata$line))"
"0","    "
"0","  all_conditions <- expand.grid("
"0","    unique(have_data$line),"
"0","    unique(have_data$treatment_days),"
"0","    unique(have_data$treatment)"
"0","  )"
"0","  names(all_conditions) <- c(""line"", ""treatment_days"", ""treatment"")"
"0","  "
"0","  have_data <- left_join(all_conditions, have_data, by = c(""line"", ""treatment_days"", ""treatment""))"
"0","  have_data$have_data[is.na(have_data$have_data)] <- FALSE"
"0","  return(have_data)"
"0","}"
"0","make_data_collection_plot <- function(have_data) {"
"0","  have_data %>%"
"0","  ggplot(mapping = aes(x = treatment, y = fct_rev(line), fill = have_data)) + "
"0","  facet_grid(. ~ treatment_days) +"
"0","  geom_tile(color = ""black"","
"0","            width = 0.8,"
"0","            height = 0.8,"
"0","            size = 0.25) + "
"0","    theme(axis.line.x = element_blank(),"
"0","        axis.line.y = element_blank(), "
"0","        panel.border = element_blank(),"
"0","        strip.background = element_blank(),"
"0","        strip.text.x = element_text(size = 12,"
"0","                                    color = ""black""),"
"0","        axis.text.x = element_text(size = 12,"
"0","                                   angle = 45,"
"0","                                   hjust = 1,"
"0","                                   color = ""black""),"
"0","        axis.text.y = element_text(size = 12,"
"0","                                   color = ""black""),"
"0","        legend.title = element_text(size = 12,"
"0","                                    color = ""black""),"
"0","        legend.text = element_text(size = 12,"
"0","                                   color = ""black""),"
"0","        panel.grid.major = element_blank(),"
"0","        panel.grid.minor = element_blank(),"
"0","        panel.background = element_blank(),"
"0","        strip.text.y = element_text(size = 12,"
"0","                                    color = ""black"","
"0","                                    angle = 0)) + "
"0","    scale_fill_manual(name = """", values = c(""grey80"", ""forestgreen""), labels = c(""Data missing"", ""Data collected""), na.value = ""grey80"") + "
"0","    xlab("""") + ylab("""") + ggtitle(""SMR data collection status"")"
"0","}"
"0","data_collection_log <- check_for_data(metadata)"
"0","make_data_collection_plot(data_collection_log)"
