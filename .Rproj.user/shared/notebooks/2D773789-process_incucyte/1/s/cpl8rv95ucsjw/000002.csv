"0","parse_key_line <- function(key_string) {"
"0","  line <- strsplit(key_string, '..', fixed = TRUE)[[1]][1]"
"0","  "
"0","  return(line)"
"0","}"
"0","parse_key_treatment <- function(key_string) {"
"0","  contains_dmso <- str_detect(key_string, ""DMSO"")"
"0","  contains_tmz <- str_detect(key_string, ""TMZ"")"
"0","  "
"0","  if (contains_dmso & !contains_tmz) {"
"0","    treatment <- ""DMSO"""
"0","  } else if (contains_tmz & !contains_dmso) {"
"0","    treatment <- ""TMZ"""
"0","  } else {"
"0","    print(""Title didn't match expected form"")"
"0","  }"
"0","  "
"0","  return(treatment)"
"0","}"
"0","parse_well_id <- function(key_string) {"
"0","  well_id <- strsplit(key_string, '..', fixed=TRUE) %>% last() %>% last() %>% strsplit('.', fixed=TRUE) %>% last() %>% last() # super janky but works"
"0","}"
"0","well_id_to_replicate <- function(well_id) {"
"0","  row_letter <- substr(well_id, start=1, stop=1)"
"0","  if (row_letter %in% c(""B"", ""E"")) {"
"0","    rep_number <- ""A"""
"0","  } else if (row_letter %in% c(""C"", ""F"")) {"
"0","    rep_number <- ""B"""
"0","  } else if (row_letter %in% c(""D"", ""G"")) {"
"0","    rep_number <- ""C"""
"0","  } else {"
"0","    rep_number <- NA"
"0","  }"
"0","}"
"0","data <- data_raw %>%"
"0","  select(-Date.Time) %>%"
"0","  gather(key = ""key"", value = ""value"", cols = -Elapsed) %>%"
"0","  mutate(line = map_chr(.x = key, .f = parse_key_line),"
"0","         treatment = map_chr(.x = key, .f = parse_key_treatment),"
"0","         well_id = map_chr(.x = key, .f = parse_well_id),"
"0","         replicate = map_chr(.x = well_id, .f = well_id_to_replicate)) %>%"
"0","  rename(time = Elapsed) %>%"
"0","  select(line, treatment, well_id, replicate, time, value)"
