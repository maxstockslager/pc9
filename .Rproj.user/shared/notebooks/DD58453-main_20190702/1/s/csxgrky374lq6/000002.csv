"0","get_axis_limits <- function(y) {"
"0","  seq(from = floor(min(y)), "
"0","       to = ceiling(max(y)),"
"0","       by = 0.2)"
"0","}"
"0","plot_biomarker_vs_methylation <- function(biomarker_name, biomarkers, genomics, show_line_names = FALSE) {"
"0","  p <- biomarkers %>%"
"0","    left_join(genomics, by = ""line"") %>%"
"0","    ggplot(mapping = aes_string(x = ""pt_mgmt"", y = biomarker_name)) + "
"0","    geom_text_repel(mapping = aes(label = line), color = ""gray"", size = 3) +"
"0","    geom_jitter(height = 0, width = 0.1) + "
"0","    theme_bw() + "
"0","    theme(panel.grid.major.x = element_blank(),"
"0","          panel.grid.minor.x = element_blank()) + "
"0","    labs(color = ""Batch"","
"0","         x = ""MGMT"")"
"0","  "
"0","  if (show_line_names) {"
"0","    p <- p + geom_text_repel(mapping = aes(label = line, color = factor(batch)),"
"0","                             direction = ""both"","
"0","                             segment.alpha = 0,"
"0","                             size = 3)"
"0","  }"
"0","  "
"0","  return(p)"
"0","}"
"0","####################"
"0","p1 <- plot_biomarker_vs_methylation(biomarker_name = ""mean_hellinger_dist"","
"0","                                   biomarkers,"
"0","                                   genomics,"
"0","                                   show_line_names = F)"
"0","p1 <- p1 #+ scale_y_log10()"
"0","####################"
"0","p2 <- plot_biomarker_vs_methylation(biomarker_name = ""mean_mass_change_vs_control"","
"0","                                   biomarkers,"
"0","                                   genomics,"
"0","                                   show_line_names = F)"
"0","p2 <- p2 + geom_hline(yintercept = 1, color = ""gray50"") + "
"0","  coord_cartesian(ylim = c()) + "
"0","  scale_y_continuous(breaks = get_axis_limits)"
"0","grid.arrange(p1, p2, ncol = 2 )"
