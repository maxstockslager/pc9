"0","plot_derived_quantity_vs_time <- function(derived_quantity_to_plot, line_to_plot, derived_quantities_by_sample) {"
"0","  sample_data <- derived_quantities_by_sample %>% filter(line == line_to_plot)"
"0","  p <- sample_data %>%"
"0","    ggplot(mapping = aes_string(x = ""treatment_days"", y = derived_quantity_to_plot)) + "
"0","    geom_point(color = ""dodgerblue3"", size = 2) + "
"0","    facet_grid(. ~ batch) +"
"0","    theme_bw() + "
"0","    theme(panel.grid.major.x = element_blank(),"
"0","          panel.grid.minor.x = element_blank(),"
"0","          strip.text = element_blank(),"
"0","          strip.background = element_blank()) + "
"0","    ggtitle(line_to_plot) + "
"0","    xlab(""Treatment duration (days)"")"
"0","  return(p)"
"0","}"
"0","p1 <- plot_derived_quantity_vs_time(derived_quantity_to_plot = ""mass_change_vs_control"","
"0","                                   line_to_plot = ""BT440"","
"0","                                   derived_quantities_by_sample)"
"0","p1 + ylab(""Mean mass normalized to control"") + geom_hline(yintercept = 1, color = ""gray50"") + coord_cartesian(ylim = c(0, 2))"
