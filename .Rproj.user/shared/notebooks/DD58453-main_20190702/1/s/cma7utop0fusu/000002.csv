"0","calculate_survival_curve <- function(clinical_data, lines_to_include) {"
"0","  "
"0","  require(pracma)"
"0","  "
"0","  time_vector <- seq(from = 0, "
"0","            to = max(clinical_data$overall_survival, na.rm = T), "
"0","            length.out = 1000)"
"0","  "
"0","  survival_curve <- rep(0, length(time_vector))"
"0","  "
"0","  clinical_data_subset <- clinical_data %>% filter(line %in% lines_to_include)"
"0","  "
"0","  for (ii in seq_along(time_vector)) {"
"0","    survival_curve[ii] <- nrow(clinical_data_subset %>% filter(overall_survival > time_vector[ii]))"
"0","  }"
"0","  "
"0","  survival_curve <- survival_curve/max(survival_curve)"
"0","  "
"0","  "
"0","  median_survival <- interp1(x = survival_curve, y = time_vector, xi = 0.5)"
"0","  "
"0","  "
"0","  return(list("
"0","    time_vector = time_vector,"
"0","    survival_curve = survival_curve,"
"0","    median_survival = median_survival"
"0","  ))"
"0","}"
"0","survival_methylated <- calculate_survival_curve(clinical_data = clinical,"
"0","                                                lines = metadata %>% filter(pt_mgmt == ""methylated"") %>% .$line %>% unique())"
"2","Points in argument in 'x' unsorted; will be sorted."
"2","There are duplicated values in 'x'; mean will be tried."
"0","survival_unmethylated <- calculate_survival_curve(clinical_data = clinical,"
"0","                                                lines = metadata %>% filter(pt_mgmt == ""unmethylated"") %>% .$line %>% unique())"
"2","Points in argument in 'x' unsorted; will be sorted."
"2","There are duplicated values in 'x'; mean will be tried."
"0","ggplot() + "
"0","  geom_line(mapping = aes(x = survival_methylated$time_vector, y = survival_methylated$survival_curve), color = ""gray60"", size = 1) + "
"0","  geom_line(mapping = aes(x = survival_unmethylated$time_vector, y = survival_unmethylated$survival_curve), color = ""red"", size = 1) + "
"0","  xlab(""Days"") + "
"0","  ylab(""Cumulative survival"") + "
"0","  scale_x_continuous(expand = c(0,0)) +"
"0","  # coord_cartesian(xlim = c(0, 11)) +"
"0","  # coord_cartesian(xlim = c(0, 70)) +"
"0","  theme_bw() + "
"0","  theme("
"0","    panel.grid.major = element_blank(),"
"0","    panel.grid.minor = element_blank()"
"0","  ) + "
"0","  ggtitle(""MGMT"")"
